// Test bfgs on a poorly scaled quadratic using inverse update

import optimize3
import "quadratic.morpho"

var f = Quadratic([1.3, -0.5, 0.9, 1.2, 5], [1,5,0.1,3,0.1]).func() 

var adapt = FunctionAdapter(f, start=Matrix(5))

class XInvBFGSController is InvBFGSController {
  report(i) {
    super.report(i)
    print self.B 
  }
}

var control = XInvBFGSController(adapt)

control.optimize(20)

print "Solution:"
print adapt.get()
